(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["bb44487a"],{3991:function(t,e,a){"use strict";var o=a("af45"),i=a.n(o);i.a},af45:function(t,e,a){},d2f6:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"row q-pa-md q-pt-xl bg-sky"},[a("p",{staticClass:"pagetit"},[t._v("徐汇区水质监控决策分析")]),a("q-tabs",{staticClass:"tab"},[a("q-route-tab",{staticClass:"text-grey-4 bg-black",attrs:{slot:"title",to:"/",exact:""},slot:"title"},[t._v("单个站点")]),a("q-route-tab",{staticClass:"text-grey-4  bg-black",attrs:{slot:"title",to:"/water",exact:""},slot:"title"},[t._v("站点对比")])],1),a("div",{staticClass:"col-4 q-pr-sm relative-position"},[a("div",{staticClass:"fit",attrs:{id:"baidumap"}})]),a("div",{staticClass:"col-8 q-pl-sm"},[a("div",{staticClass:"row full-height"},[a("div",{staticClass:"col-12 q-pb-xs half-height"},[a("div",{staticClass:"fit cardbg relative-position"},[a("q-btn-dropdown",{staticClass:"chosele text-positive",attrs:{color:"primary",label:t.chosenele}},[a("q-list",{attrs:{dense:"",link:"",highlight:""}},t._l(t.elename,function(e,o){return a("q-item",{key:e,attrs:{dark:""}},[a("q-radio",{staticClass:"radiotext",attrs:{dark:"",val:e,label:e},on:{input:t.choosele},model:{value:t.chosenele,callback:function(e){t.chosenele=e},expression:"chosenele"}})],1)}))],1),t.pointInPlolygon.length?a("div",{staticClass:"absolute-left q-pa-sm chipzhand"},t._l(t.pointInPlolygon,function(e,o){return a("q-chip",{key:o,style:{color:t.getColor(t.PName,t.indexOf(t.PName,e.name)),background:"rgba(255,255,255,0.1)"}},[t._v(t._s(e.name))])})):t._e(),a("i-echart",{ref:"timeline",staticClass:"fit",attrs:{option:t.option}})],1)]),a("div",{staticClass:"col-8 q-pr-xs q-pt-xs half-height"},[a("div",{staticClass:"fit cardbg"},[a("i-echart",{ref:"river",staticClass:"fit",attrs:{option:t.riveropt}})],1)]),a("div",{staticClass:"col-4 q-pl-xs q-pt-xs half-height"},[a("div",{staticClass:"fit cardbg"},[a("i-echart",{staticClass:"fit",attrs:{option:t.radaropt}})],1)])])])],1)},i=[];o._withStripped=!0;a("456d"),a("cadf"),a("ffc1"),a("ac6a"),a("f751"),a("7f7f");var n=a("bd29"),r=(a("1fe0"),a("5a05")),l=a("4fef"),s=a("59f1"),c=a("4397"),p=a("a474"),h=a("22b6"),f=a("8dad"),d=a("7947");a("bbd5");a("a00a");var m=s.map(function(t){return t.name}),u=["#FF6757","#FFCB57","#5976D6"],g=["设备异常","统计异常","序列异常"],b={splitLine:{show:!0,lineStyle:{color:"#666",opacity:.1}},axisTick:{show:!1},axisLine:{show:!1,lineStyle:{color:"#999",width:1}}},y=["temperature","pH","EC","ORP","DO","turbidity","transparency","COD","P","NH3N","flux"],v=[];y.forEach(function(t){v.push({name:t,min:-.5,max:1})});var S={name:"WaterQuality",components:{iEchart:n["a"],api:p["a"]},data:function(){return{months:"",chosenele:"temperature",elename:y,PName:m,pointInPlolygon:[],radaropt:{title:{text:"站点健康度雷达图",top:10,left:10,textStyle:{color:"#fff",fontStyle:"normal",fontFamily:"微软雅黑",fontSize:14}},tooltip:Object.assign({},l["a"],{show:!0,trigger:"item",axisPointer:{type:"shadow",lineStyle:{color:"#FFD77F"}}}),radar:{center:["50%","55%"],radius:"60%",startAngle:90,splitNumber:3,shape:"circle",axisLine:{lineStyle:{color:"rgba(238, 197, 102, 0.1)"}},splitArea:{show:!0,areaStyle:{color:["rgba(255,103,87, 0.2)","rgba(255,203,87, 0.1)","rgba(131,236,176, 0.2)"].reverse()}},splitLine:{lineStyle:{color:["rgba(255,255,255, 0.1)","rgba(131,236,176, 0)","rgba(255,103,87, 0.8)"]}},name:{show:!0,color:"rgba(255,255,255,0.7)",fontStyle:"normal",fontFamily:"微软雅黑",fontSize:10},indicator:v},series:[{name:"健康度",type:"radar",symbol:"circle",symbolSize:6,label:{show:!1},areaStyle:{normal:{color:"rgba(245, 166, 35, 0.1)"}},itemStyle:{color:"rgba(245, 166, 35, 1)",borderColor:"rgba(245, 166, 35, 0.3)"},lineStyle:{normal:{type:"dashed",color:"rgba(245, 166, 35, 1)",width:1}},data:null}]},riveropt:{color:u,title:{text:"站点异常类型统计变化",top:10,left:10,textStyle:{color:"#fff",fontStyle:"normal",fontFamily:"微软雅黑",fontSize:14}},tooltip:Object.assign({},l["a"],{show:!0,trigger:"axis",axisPointer:{lineStyle:{color:"#FFD77F",type:"dashed"}}}),legend:{width:"auto",top:"12%",itemGap:16,itemWidth:20,itemHeight:14,icon:"circle",data:g,textStyle:{color:"#a8aab0",fontStyle:"normal",fontFamily:"微软雅黑",fontSize:12}},singleAxis:Object.assign({},{top:"25%",bottom:"12%",right:"3%",left:"6%",type:"category",data:this.months,axisPointer:{type:"line",animation:!0,label:{show:!0,backgroundColor:"#000",shadowBlur:0}},splitLine:{show:!1},axisLabel:{rotate:"20",interval:0,align:"right",textStyle:{color:"rgba(255,255,255,0.7)",fontStyle:"normal",fontFamily:"微软雅黑",fontSize:10}}},b),series:[{type:"themeRiver",top:"15%",itemStyle:{opacity:.4,emphasis:{shadowBlur:20,shadowColor:"rgba(0, 0, 0, 0.8)"}},data:null,label:{normal:{show:!1}}}]},option:{dataZoom:[{show:!0,height:25,bottom:20,right:120,left:85,start:40,end:100,borderColor:"#6a7985",dataBackground:{lineStyle:{color:"#5daec1"},areaStyle:{color:"#5daec1"}},handleStyle:{},fillerColor:"rgba(246,164,54,0.2)",textStyle:{color:"rgba(255,255,255,0.8)"}},{type:"inside"}],title:{text:"",top:10,left:10,textStyle:{color:"#fff",fontStyle:"normal",fontFamily:"微软雅黑",fontSize:14}},tooltip:Object.assign({},l["a"],{show:!0,position:function(t,e,a,o,i){return[[t[0]-i.contentSize[0],t[0]][+(t[0]<i.viewSize[0]/2)],"25%"]},trigger:"axis",axisPointer:{type:"shadow",lineStyle:{color:"#FFD77F"}}}),grid:{left:"4%",right:"5%",bottom:"18%",top:"20%",containLabel:!0},legend:{show:!1,data:this.elename,selected:{COD:!1,DO:!1,EC:!1,NH3N:!1,ORP:!1,P:!1,flux:!1,pH:!1,temperature:!0,transparency:!1,turbidity:!1}},xAxis:[Object.assign({},{type:"time",boundaryGap:!0,axisLabel:{interval:5,margin:5,textStyle:{color:"rgba(255,255,255,0.7)",fontStyle:"normal",fontFamily:"微软雅黑",fontSize:10}}},b)],yAxis:[{type:"value",splitNumber:6,axisLabel:{textStyle:{color:"rgba(255,255,255,0.8)",fontStyle:"normal",fontFamily:"微软雅黑",fontSize:12}},offset:5,axisTick:{show:!1},splitLine:{show:!0,lineStyle:{color:"#ccc",opacity:.15}}}],series:null,animation:!1}}},mounted:function(){this.drawLine()},methods:{indexOf:function(t,e){if(Array.prototype.indexOf)return t.indexOf(e);for(var a=0;a<t.length;a++)return t[a]===e?a:-1},getColor:function(t,e){t.length;return this.$echarts.color.modifyHSL("#EB7F49",Math.round(7*e))},setAbnormal:function(t){var e=this;Object(h["a"])(p["a"].abnormal,{group:t}).then(function(t){t=t.data,console.log(t),e.riveropt.series[0].data=e.shapeRiverData(t),e.riveropt.singleAxis.data=t.month})},setHealth:function(t){var e=this;Object(h["a"])(p["a"].health,{group:t}).then(function(t){t=t.data;var a=[];t.forEach(function(t){console.log(t.name);var o=c["a"].radar(t.name,e.getColor(m,e.indexOf(m,t.name)));o.data=[t.value],a.push(o)}),e.radaropt.series=a})},choosele:function(){var t=this;console.log("===="+this.chosenele);var e={};this.elename.forEach(function(a){e[a]=t.chosenele==a}),this.option.legend.selected=e,console.log(e)},shapeHeatData:function(t){var e=[],a=t.value;return a.forEach(function(t,a){t.forEach(function(t,o){e.push([o,a,t])})}),e},shapeRiverData:function(t){var e=[],a=t.value,o=t.yfields;return a.forEach(function(t,a){t.forEach(function(t,i){e.push([i,t,o[a]])})}),e},drawLine:function(){var t=this,e=this.$echarts.init(document.getElementById("baidumap"));d["a"].forEach(function(t,e){t.lineStyle={normal:{color:"#4AB9CE",opacity:.7,width:5}}}),this.bmapoption={tooltip:{show:!1},bmap:{center:[121.44061699999999,31.152043],zoom:14,maxZoom:20,roam:!1,mapStyle:{styleJson:r["a"]},enableMapClick:!1},series:[{name:"监测站",type:"scatter",coordinateSystem:"bmap",symbolSize:15,rippleEffect:{brushType:"stroke"},label:{emphasis:{show:!0,position:"right",distance:12,formatter:"{b}",textStyle:{color:"#eee",fontSize:12}}},showEffectOn:"render",itemStyle:{color:function(e){return t.getColor(m,t.indexOf(m,e.name))}},data:s},{type:"lines",coordinateSystem:"bmap",polyline:!0,data:f["a"].concat(d["a"]),silent:!0,lineStyle:{normal:{color:"#74D3E5",opacity:.6,width:3}},progressiveThreshold:500,progressive:200}]};var a=null;window.addEventListener("resize",function(){a=setTimeout(function(){t.baiduMap.resize();var e=t.bmap.getCenter();t.bmap.checkResize(),t.bmap.setCenter(e)},100)}),a&&clearTimeout(a),e.setOption(this.bmapoption),this.baiduMap=e;var o=e.getModel().getComponent("bmap").getBMap();o.enableScrollWheelZoom(),o.enableAutoResize(),this.bmap=o;var i={strokeColor:"red",fillColor:"red",strokeWeight:3,strokeOpacity:.8,fillOpacity:.1,strokeStyle:"solid"};this.drawingManager=new BMapLib.DrawingManager(o,{isOpen:!1,enableDrawingTool:!0,drawingToolOptions:{anchor:BMAP_ANCHOR_TOP_RIGHT,offset:new BMap.Size(5,5),scale:.5,drawingModes:[BMAP_DRAWING_POLYGON]},circleOptions:i,polygonOptions:i});var n=[],l=function(e){for(var a=0;a<n.length;a++)o.removeOverlay(n[a]);n=[];var i=e.overlay;switch(n.push(i),e.drawingMode){case"polygon":t.pointInPlolygon=s.filter(function(t){return BMapLib.GeoUtils.isPointInPolygon(new BMap.Point(t.value[0],t.value[1]),i)});var r=t.pointInPlolygon.map(function(t){return t.name});t.setAll(r);break}};this.drawingManager.addEventListener("overlaycomplete",l)},setAll:function(t){this.chooseZhand(t),this.setAbnormal(t),this.setHealth(t)},chooseZhand:function(t){var e=this;Object(h["a"])(p["a"].elements,{group:t}).then(function(t){t=t.data;var a=[];Object.entries(t).forEach(function(t){var o=t[0],i=t[1],n=i.timestamp,r=i.data;Object.keys(r).forEach(function(t,i){var l=[];r[t].forEach(function(t,e){var a=[];a[0]=n[e],a[1]=t,l.push(a)});var s=c["a"].line(t,e.getColor(m,e.indexOf(m,o)));s.data=l,l.id=o+t,a.push(s)})}),e.option.series=a})}}},w=S,x=(a("3991"),a("2877")),C=Object(x["a"])(w,o,i,!1,null,null,null);C.options.__file="Water1.vue";e["default"]=C.exports}}]);